!function(){"use strict";var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};function e(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}function n(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function r(t,e){return t(e={exports:{}},e.exports),e.exports}var o=r(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){return function(t,e){this.resolve=t,this.reject=e}}();e.DelayedPromise=n;var r=function(){return function(t,e,n){this.promiseID=t,this.func=e,this.arg=n}}(),o=function(){function t(){this.devMode=!1,this.promises={},this.promiseCounter=0;var t=window;this.webkit=t.webkit}return t.prototype.beginPromise=function(t,e,o){var i=this;if(!t||!e){var u="BeginPromise: argument null: "+t+"."+e;return this.log(u),Promise.reject(u)}return new Promise(function(u,s){try{if(i.webkit&&i.webkit.messageHandlers){var a=i.webkit.messageHandlers[t];if(a&&"function"==typeof a.postMessage){var c=i.generateID(),f=new n(u,s);i.promises[c]=f,i.log("BeginPromise: "+t+"."+e+" ["+c+"]");var p=new r(c,e,o||{});return void a.postMessage(p)}var l='The namespace "'+t+'" does not exist';return i.log(l),void s(l)}}catch(t){l="BeginPromise: exception: "+JSON.stringify(t);return i.log(l),void s(l)}})},t.prototype.endPromise=function(t,e,n){this.log("EndPromise: ["+t+"] data: "+JSON.stringify(e)+", error: "+JSON.stringify(n));var r=this.promises[t];r?(n?r.reject(n?n.value:void 0):r.resolve(e?e.value:void 0),delete this.promises[t]):this.log("EndPromise: not found")},t.prototype.generateID=function(){return this.promiseCounter++,"p-"+this.promiseCounter},t.prototype.log=function(t){this.devMode&&console.log(t)},t}();e.Runtime=o});n(o);o.DelayedPromise,o.Runtime;var i=r(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){this.name=t,this.runtime=e}return t.prototype.invoke=function(t,e){return this.runtime.beginPromise(this.name,t,e)},t}();e.default=n});n(i);var u=r(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){var n=window;return!n[t]&&(n[t]=e,!0)}});n(u);var s=r(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Runtime=o.Runtime,e.Namespace=i.default,e.inject=u.default});n(s);var a=s.Runtime,c=s.Namespace,f=s.inject,p=function(t){function n(e){return t.call(this,"factory",e)||this}return e(n,t),n.prototype.array=function(){return this.invoke("array",null)},n.prototype.object=function(){return this.invoke("object",null)},n}(c),l=function(t){function n(e){return t.call(this,"math",e)||this}return e(n,t),n.prototype.add=function(t){return this.invoke("add",t).then(function(t){return t})},n}(c),h=function(t){function n(e){return t.call(this,"alert",e)||this}return e(n,t),n.prototype.sheetAsync=function(){return this.invoke("sheetAsync",null)},n}(c),d=function(){return function(t){this.math=new l(t),this.alert=new h(t),this.factory=new p(t)}}();!function(){var t=new a,e=new d(t);f("__WKJoint",t),f("MyJavaScriptAPI",e)}()}();
