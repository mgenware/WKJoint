"use strict";var DelayedPromise=function(){return function(e,t){this.resolve=e,this.reject=t}}(),WKJCall=function(){return function(e,t,i){this.promiseID=e,this.func=t,this.arg=i}}(),WKJointRuntime=function(){function e(){this.promises={},this.promiseCounter=0}return e.prototype.beginPromise=function(e,t,i){var n=this;if(!e||!t)return this.log("BeginPromise: argument null: "+e+"."+t),null;return new Promise(function(o,r){var s=n.generateID(),u=new DelayedPromise(o,r);n.promises[s]=u,n.log("BeginPromise: "+e+"."+t+" ["+s+"]");try{var a=window;if(a.webkit&&a.webkit.messageHandlers){var l=a.webkit.messageHandlers[e];if(l&&"function"==typeof l.postMessage){var f=new WKJCall(s,t,i);l.postMessage(f)}}}catch(e){n.log("BeginPromise: exception: "+JSON.stringify(e))}})},e.prototype.endPromise=function(e,t,i){this.log("EndPromise: ["+e+"] data: "+JSON.stringify(t)+", error: "+JSON.stringify(i));var n=this.promises[e];n?(i?n.reject(i?i.default:void 0):n.resolve(t?t.default:void 0),delete this.promises[e]):this.log("EndPromise: not found")},e.prototype.generateID=function(){return this.promiseCounter++,"p-"+this.promiseCounter},e.prototype.log=function(e){this.devMode&&console.log(e)},e}();!function(){var e=window;e.__WKJoint||(e.__WKJoint=new WKJointRuntime)}();